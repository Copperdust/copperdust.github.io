<html>

<head>
  <title>Pokemon Multiple Choice for Sleep</title>

  <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>
</head>

<style>
  .hidden {
    position: absolute;
    opacity: 0;
  }
</style>

<body>
  <h1>Pokemon Multiple Choice for Sleep</h1>
  <section class="main">
    <div class="top">
      <div class="bad">0</div>
      <div class="images"><img id="mainImage" src="https://upload.wikimedia.org/wikipedia/commons/5/55/Question_Mark.svg" alt="?"></div>
      <div class="good">0</div>
    </div>
    <div class="controls">
      <button id="b1">name goes here</button>
      <button id="b2">name goes here</button>
      <button id="b3">name goes here</button>
      <button id="b4">name goes here</button>
    </div>
  </section>
  <audio controls id="audio" class="hidden">
    <source src="pokemon-lofi-music.mp3" type="audio/mp3">
  </audio>
  
  <script>
    const api = 'https://pokeapi.co/api/v2/';
    const possibilities = 4;

    function getOnePokemon() {
      endpoint = 'pokemon/';
      random = Math.floor(Math.random() * Math.floor(100)) + 1;
      return $.ajax({
        url: api + endpoint + random,
      });
    }
    async function newChallenge() {
      // Get 4 new pokemon
      var pokes = [];
      for (let index = 0; index < possibilities; index++) {
        pokes.push(getOnePokemon());
      }
      var incorrect = [];
      Promise.all(pokes).then((values) => {
        // Choose one of the four as the correct answer
        for (let index = 0; index < possibilities; index++) {
          if (index == 0) {
            var correct = values[index];
          } else {
            incorrect.push(values[index]);
          }
        }
        // Choose correct button ID
        var correctId = Math.floor(Math.random() * Math.floor(4)) + 1;
        for (let index = 1; index < possibilities + 1; index++) {
          if (index == correctId) {
            $('#b' + index)
              .text(correct.name)
              .addClass('correct')
              .removeClass('incorrect');
            $('#mainImage').attr('src',correct.sprites.front_default);
          } else {
            let poke = incorrect.pop();
            $('#b' + index)
              .text(poke.name)
              .removeClass('correct')
              .addClass('incorrect');
          }
        }
      });
      // Set the image for the correct answer
      // Load the names into the buttons
      // Mark the button with the correct answer
      // If bad button is clicked, increase bad counter
      // If good button is clicked, increase good counter
      // Call this function again
    }
    // On click event
    function increaseCounter( selector ) {
      var current = parseInt($(selector).text());
      $(selector).text(++current);
    }
    const audio = $('#audio')
    $(document).on('click', '.correct', function (e) {
      increaseCounter('.good');
      audio.play()
      newChallenge();
    });
    $(document).on('click', '.incorrect', function (e) {
      increaseCounter('.bad');
      audio.stop()
      newChallenge();
    });
    newChallenge();
  </script>
</body>

</html>